<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Closet Stylized - Diseño de Bordados</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            background-color: #8B1A1A;
            color: white;
            padding: 10px 0;
        }
        .nav {
            display: flex;
            justify-content: space-around;
        }
        .nav a {
            color: white;
            text-decoration: none;
            padding: 10px;
        }
        .main-content {
            display: flex;
            margin-top: 20px;
            gap: 20px;
        }
        .embroidery-options {
            flex: 1;
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .preview-area {
            flex: 1;
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .section-title {
            color: #8B1A1A;
            border-bottom: 2px solid #8B1A1A;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .option-group {
            margin-bottom: 20px;
        }
        .option-title {
            color: #8B1A1A;
            margin-bottom: 10px;
            font-weight: bold;
        }
        .color-options {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
        }
        .color-option.selected {
            border: 2px solid #000;
        }
        .pattern-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        .pattern-option {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
            cursor: pointer;
        }
        .pattern-option.selected {
            border: 2px solid #8B1A1A;
        }
        .pattern-img {
            width: 100%;
            height: 80px;
            object-fit: contain;
        }
        .text-option {
            margin-bottom: 15px;
        }
        .text-input {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
        }
        .font-selector {
            width: 100%;
            padding: 8px;
        }
        .canvas-container {
            border: 1px dashed #ccc;
            margin-bottom: 20px;
            position: relative;
            height: 300px;
            background-color: #f9f9f9;
        }
        .canvas-content {
            position: relative;
            width: 100%;
            height: 100%;
        }
        .tshirt-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        .embroidery-preview {
            position: absolute;
            transform: translate(-50%, -50%);
            padding: 10px;
            max-width: 120px;
            max-height: 120px;
            font-weight: bold;
            text-align: center;
            /* Posición inicial (pecho izquierdo) */
            top: 30%;
            left: 30%;
        }
        .price-summary {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }
        .price-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        .price-total {
            font-weight: bold;
            border-top: 1px solid #ddd;
            padding-top: 10px;
            margin-top: 10px;
        }
        .button {
            background-color: #8B1A1A;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            width: 100%;
            margin-top: 15px;
        }
        .button:hover {
            background-color: #6d1414;
        }
        .button-secondary {
            background-color: #555;
        }
        .button-secondary:hover {
            background-color: #444;
        }
        /* Tamaños de bordado */
        .embroidery-preview.pequeno {
            font-size: 14px;
        }
        .embroidery-preview.mediano {
            font-size: 18px;
        }
        .embroidery-preview.grande {
            font-size: 24px;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <div class="nav">
                 <a href="index.html">Inicio</a>
                    <a href="diseño.html">Diseñar</a>
                    <a href="galeria.html">Galería</a>
                    <a href="inicio_de_sesion.html">Iniciar Sesión</a>
                    <a href="carrito.html">carrito</a>
                    <a href="bordados.html">diseño bordado</a>
                    <a href="moodboard.html">colaboraciones</a>
                    <a href="restricciones.html">consejos de diseño</a>
            </div>
        </div>
    </div>
    
   <!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diseñador de Bordados</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        #canvas {
            border: 2px dashed #9CA3AF;
            background-image: url('https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/2f32e00a-60cd-4911-97e3-85052b12c9f4.png');
            background-repeat: repeat;
            background-size: 20px 20px;
            cursor: crosshair;
        }
        .font-option {
            font-family: inherit;
            padding: 0.5rem;
            margin: 0.25rem;
            border-radius: 0.25rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .font-option:hover {
            transform: scale(1.05);
            box-shadow: 0 0 8px rgba(0,0,0,0.1);
        }
        .size-option {
            padding: 0.5rem 1rem;
            margin: 0.25rem;
            border-radius: 0.25rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .size-option:hover {
            background-color: #E5E7EB;
        }
        .size-option.selected {
            background-color: #3B82F6;
            color: white;
        }
    </style>
</head>
<body class="font-sans bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <h1 class="text-3xl font-bold text-center mb-6 text-gray-800">Diseñador de Bordados</h1>
        
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Panel de herramientas -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold mb-4 text-gray-700">Herramientas</h2>
                
                <!-- Selección de color -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Color del hilo</label>
                    <div class="flex flex-wrap">
                        <div class="color-option w-8 h-8 m-1 rounded-full cursor-pointer bg-red-500" data-color="#EF4444"></div>
                        <div class="color-option w-8 h-8 m-1 rounded-full cursor-pointer bg-blue-500" data-color="#3B82F6"></div>
                        <div class="color-option w-8 h-8 m-1 rounded-full cursor-pointer bg-green-500" data-color="#10B981"></div>
                        <div class="color-option w-8 h-8 m-1 rounded-full cursor-pointer bg-yellow-500" data-color="#F59E0B"></div>
                        <div class="color-option w-8 h-8 m-1 rounded-full cursor-pointer bg-purple-500" data-color="#8B5CF6"></div>
                        <div class="color-option w-8 h-8 m-1 rounded-full cursor-pointer bg-pink-500" data-color="#EC4899"></div>
                        <div class="color-option w-8 h-8 m-1 rounded-full cursor-pointer bg-black" data-color="#000000"></div>
                        <div class="color-option w-8 h-8 m-1 rounded-full cursor-pointer bg-white border border-gray-300" data-color="#FFFFFF"></div>
                    </div>
                    <input type="color" id="customColor" class="mt-2 w-full h-10 cursor-pointer">
                </div>
                
                <!-- Selección de tipo de letra -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Tipografía</label>
                    <div class="flex flex-col">
                        <button class="font-option bg-gray-100 text-lg" style="font-family: 'Arial', sans-serif;" data-font="Arial, sans-serif">Arial</button>
                        <button class="font-option bg-gray-100 text-lg" style="font-family: 'Times New Roman', serif;" data-font="'Times New Roman', serif">Times New Roman</button>
                        <button class="font-option bg-gray-100 text-lg" style="font-family: 'Courier New', monospace;" data-font="'Courier New', monospace">Courier New</button>
                        <button class="font-option bg-gray-100 text-xl" style="font-family: 'Brush Script MT', cursive;" data-font="'Brush Script MT', cursive">Brush Script</button>
                        <button class="font-option bg-gray-100 text-lg" style="font-family: 'Georgia', serif;" data-font="'Georgia', serif">Georgia</button>
                        <button class="font-option bg-gray-100 text-lg" style="font-family: 'Verdana', sans-serif;" data-font="'Verdana', sans-serif">Verdana</button>
                    </div>
                </div>
                
                <!-- Tamaño del bordado -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Tamaño (cm)</label>
                    <div class="flex flex-wrap">
                        <button class="size-option bg-gray-200" data-size="10">10x10 cm</button>
                        <button class="size-option bg-gray-200" data-size="15">15x15 cm</button>
                        <button class="size-option bg-gray-200 selected" data-size="20">20x20 cm</button>
                        <button class="size-option bg-gray-200" data-size="25">25x25 cm</button>
                        <button class="size-option bg-gray-200" data-size="30">30x30 cm</button>
                    </div>
                </div>
                
                <!-- Texto personalizado -->
                <div class="mb-6">
                    <label for="customText" class="block text-sm font-medium text-gray-700 mb-2">Texto personalizado</label>
                    <input type="text" id="customText" class="w-full p-2 border border-gray-300 rounded" placeholder="Escribe tu texto aquí">
                    <button id="addTextBtn" class="mt-2 bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600 transition">Añadir texto</button>
                </div>
                
                <!-- Cargar imagen -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Cargar diseño</label>
                    <input type="file" id="uploadImage" accept="image/*" class="block w-full text-sm text-gray-500
                        file:mr-4 file:py-2 file:px-4
                        file:rounded-md file:border-0
                        file:text-sm file:font-semibold
                        file:bg-blue-50 file:text-blue-700
                        hover:file:bg-blue-100">
                </div>
                
                <!-- Botones de acción -->
                <div class="flex justify-between">
                    <button id="clearCanvas" class="bg-gray-200 text-gray-800 py-2 px-4 rounded hover:bg-gray-300 transition">Limpiar</button>
                    <button id="undoBtn" class="bg-gray-200 text-gray-800 py-2 px-4 rounded hover:bg-gray-300 transition">Deshacer</button>
                    <button id="saveBtn" class="bg-green-500 text-white py-2 px-4 rounded hover:bg-green-600 transition">Guardar</button>
                </div>
            </div>
            
            <!-- Área de diseño -->
            <div class="bg-white rounded-lg shadow-md p-6 col-span-2">
                <h2 class="text-xl font-semibold mb-4 text-gray-700">Área de diseño</h2>
                <div class="flex justify-center mb-4">
                    <canvas id="canvas" width="500" height="600"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Vista previa y precio -->
        <div class="mt-8 bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-semibold mb-4 text-gray-700">Vista previa y precio</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 flex items-center justify-center">
                    <canvas id="previewCanvas" width="300" height="300"></canvas>
                </div>
                <div class="flex flex-col justify-center">
                    <h3 class="text-lg font-medium text-gray-700 mb-2">Detalles del bordado</h3>
                    <div class="mb-4">
                        <p class="text-gray-600">Tamaño: <span id="selectedSizeDisplay" class="font-medium">20x20</span> cm</p>
                        <p class="text-gray-600">Complejidad: <span id="complexity" class="font-medium">Media</span></p>
                        <p class="text-gray-600">Tiempo estimado: <span id="timeEstimate" class="font-medium">3-4 días</span></p>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <p class="text-gray-700 mb-1">Precio total:</p>
                        <p class="text-3xl font-bold text-blue-600">$<span id="totalPrice">45,000</span> COP</p>
                        <p class="text-sm text-gray-500">IVA incluido</p>
                    </div>
                    <button class="mt-4 bg-blue-600 text-white py-3 px-6 rounded-lg text-lg hover:bg-blue-700 transition">Confirmar pedido</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            const previewCanvas = document.getElementById('previewCanvas');
            const previewCtx = previewCanvas.getContext('2d');
            const colorOptions = document.querySelectorAll('.color-option');
            const customColor = document.getElementById('customColor');
            const fontOptions = document.querySelectorAll('.font-option');
            const sizeOptions = document.querySelectorAll('.size-option');
            const customText = document.getElementById('customText');
            const addTextBtn = document.getElementById('addTextBtn');
            const clearCanvas = document.getElementById('clearCanvas');
            const undoBtn = document.getElementById('undoBtn');
            const saveBtn = document.getElementById('saveBtn');
            const uploadImage = document.getElementById('uploadImage');
            const selectedSizeDisplay = document.getElementById('selectedSizeDisplay');
            const totalPrice = document.getElementById('totalPrice');
            
            let currentColor = '#3B82F6';
            let currentFont = 'Arial, sans-serif';
            let currentSize = 20;
            let isDrawing = false;
            let lastX = 0;
            let lastY = 0;
            let drawingHistory = [];
            let historyIndex = -1;
            
            // Inicializar el lienzo
            function initCanvas() {
                ctx.fillStyle = 'white';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                saveCanvasState();
            }
            
            // Guardar estado del lienzo
            function saveCanvasState() {
                historyIndex++;
                if (historyIndex < drawingHistory.length) {
                    drawingHistory.length = historyIndex;
                }
                drawingHistory.push(canvas.toDataURL());
            }
            
            // Dibujar
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
            
            function startDrawing(e) {
                isDrawing = true;
                [lastX, lastY] = [e.offsetX, e.offsetY];
            }
            
            function draw(e) {
                if (!isDrawing) return;
                
                ctx.beginPath();
                ctx.moveTo(lastX, lastY);
                ctx.lineTo(e.offsetX, e.offsetY);
                ctx.strokeStyle = currentColor;
                ctx.lineWidth = 2;
                ctx.lineCap = 'round';
                ctx.stroke();
                
                [lastX, lastY] = [e.offsetX, e.offsetY];
            }
            
            function stopDrawing() {
                if (isDrawing) {
                    saveCanvasState();
                    updatePreview();
                    calculatePrice();
                }
                isDrawing = false;
            }
            
            // Selección de color
            colorOptions.forEach(option => {
                option.addEventListener('click', function() {
                    currentColor = this.getAttribute('data-color');
                    customColor.value = currentColor;
                });
            });
            
            customColor.addEventListener('input', function() {
                currentColor = this.value;
            });
            
            // Selección de fuente
            fontOptions.forEach(option => {
                option.addEventListener('click', function() {
                    currentFont = this.getAttribute('data-font');
                });
            });
            
            // Selección de tamaño
            sizeOptions.forEach(option => {
                option.addEventListener('click', function() {
                    sizeOptions.forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    currentSize = parseInt(this.getAttribute('data-size'));
                    selectedSizeDisplay.textContent = `${currentSize}x${currentSize}`;
                    calculatePrice();
                    updatePreview();
                });
            });
            
            // Añadir texto
            addTextBtn.addEventListener('click', function() {
                if (customText.value.trim() !== '') {
                    ctx.font = `24px ${currentFont}`;
                    ctx.fillStyle = currentColor;
                    ctx.textAlign = 'left';
                    ctx.textBaseline = 'top';
                    ctx.fillText(customText.value, 20, 20);
                    saveCanvasState();
                    updatePreview();
                    calculatePrice();
                }
            });
            
            // Cargar imagen
            uploadImage.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        const img = new Image();
                        img.onload = function() {
                            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                            saveCanvasState();
                            updatePreview();
                            calculatePrice();
                        };
                        img.src = event.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Limpiar lienzo
            clearCanvas.addEventListener('click', function() {
                if (confirm('¿Estás seguro de que quieres limpiar el diseño?')) {
                    initCanvas();
                    updatePreview();
                    calculatePrice();
                }
            });
            
            // Deshacer
            undoBtn.addEventListener('click', function() {
                if (historyIndex > 0) {
                    historyIndex--;
                    const img = new Image();
                    img.onload = function() {
                        ctx.clearRect(0, 0, canvas.width, canvas.height);
                        ctx.drawImage(img, 0, 0);
                        updatePreview();
                        calculatePrice();
                    };
                    img.src = drawingHistory[historyIndex];
                }
            });
            
            // Guardar diseño
            saveBtn.addEventListener('click', function() {
                const link = document.createElement('a');
                link.download = 'bordado-diseno.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
            });
            
            // Actualizar vista previa
            function updatePreview() {
                previewCtx.clearRect(0, 0, previewCanvas.width, previewCanvas.height);
                
                // Escalar el diseño para la vista previa
                const scale = Math.min(
                    previewCanvas.width / canvas.width,
                    previewCanvas.height / canvas.height
                );
                
                const scaledWidth = canvas.width * scale;
                const scaledHeight = canvas.height * scale;
                const offsetX = (previewCanvas.width - scaledWidth) / 2;
                const offsetY = (previewCanvas.height - scaledHeight) / 2;
                
                const img = new Image();
                img.onload = function() {
                    previewCtx.drawImage(img, offsetX, offsetY, scaledWidth, scaledHeight);
                    
                    // Añadir marco de referencia del tamaño
                    previewCtx.strokeStyle = 'rgba(0, 0, 0, 0.5)';
                    previewCtx.setLineDash([5, 5]);
                    previewCtx.strokeRect(
                        offsetX + (previewCanvas.width - currentSize * 10) / 2,
                        offsetY + (previewCanvas.height - currentSize * 10) / 2,
                        currentSize * 10,
                        currentSize * 10
                    );
                    previewCtx.setLineDash([]);
                };
                img.src = canvas.toDataURL();
            }
            
            // Calcular precio
            function calculatePrice() {
                const basePrice = 10000; // Precio base para 10x10 cm
                const sizeFactor = currentSize / 10; // Multiplicador por tamaño
                let complexityFactor = 1.0; // Factor de complejidad
                
                // Estimación simple de complejidad basada en contenido del lienzo
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height).data;
                let nonWhitePixels = 0;
                
                for (let i = 0; i < imageData.length; i += 4) {
                    // Si no es blanco (con algo de tolerancia)
                    if (imageData[i] < 250 || imageData[i+1] < 250 || imageData[i+2] < 250) {
                        nonWhitePixels++;
                    }
                }
                
                const coverage = nonWhitePixels / (canvas.width * canvas.height);
                
                if (coverage < 0.1) {
                    complexityFactor = 0.8; // Baja complejidad
                    document.getElementById('complexity').textContent = 'Baja';
                    document.getElementById('timeEstimate').textContent = '2-3 días';
                } else if (coverage < 0.3) {
                    complexityFactor = 1.0; // Media complejidad
                    document.getElementById('complexity').textContent = 'Media';
                    document.getElementById('timeEstimate').textContent = '3-4 días';
                } else {
                    complexityFactor = 1.3; // Alta complejidad
                    document.getElementById('complexity').textContent = 'Alta';
                    document.getElementById('timeEstimate').textContent = '4-5 días';
                }
                
                const finalPrice = Math.round(basePrice * sizeFactor * complexityFactor);
                totalPrice.textContent = finalPrice.toLocaleString('es-CO');
            }
            
            // Inicialización
            initCanvas();
            updatePreview();
            calculatePrice();
        });
    </script>
</body>
</html>

